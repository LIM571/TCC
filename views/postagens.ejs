<link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">

<div class="flex p-6 space-x-6">
    <!-- Tópicos -->
    <div class="w-2/8">
        <div id="topicos-container" class="bg-red-800 p-4 rounded-lg">
            <%- include(`topico`) %>
        </div>
    </div>

    <!-- Postagens -->
   
    <div class="flex justify-center">
        <div class="w-4/8"> <!-- Mantido a largura em 4/8 -->
            <div id="postagens-container" class="flex flex-col space-y-4 p-4 rounded-lg shadow-lg text-center items-center">
                <% for (let j = 0; j < postagens.length; j++) { %>
                    <% const userPost = usuarios.find(user => user.id === postagens[j].usuario_id); %>
                    <% if (userPost) { %>
                        <div class="postagem flex flex-col p-6 bg-white text-center shadow-md rounded-lg">
                            <div class="flex items-center mb-2">
                                <img class="w-12 h-12 rounded-full mr-2" src="/imagens/<%= userPost.img %>" alt="User Avatar">
                                <h2 class="text-lg font-bold text-black"><%= userPost.nome %></h2>
                            </div>
                            <img class="w-full h-48 object-cover rounded-md mb-2" src="/imagens/<%= postagens[j].midia %>" alt="User Image">
                            <p class="text-black text-base mb-2">
                                <%= postagens[j].descricao %>
                            </p>
    
                            <div class="flex justify-around items-center">
                                <form action="resposta/cadastro" method="POST" class="flex items-center space-x-2">
                                    <input type="hidden" name="postagem_id" value="<%= postagens[j].id_post %>">
                                    <button type="submit" class="text-black hover:text-red-500 flex items-center space-x-1">
                                        <i class="fas fa-comment-alt fa-lg"></i>
                                        <span class="text-sm">Responder</span>
                                    </button>
                                </form>
    
                                <% if (userPost.categoria === usuarioAtual.categoria && userPost.lvl_profissional === usuarioAtual.lvl_profissional) { %>
                                    <a href="#" class="text-black hover:text-red-500 flex items-center space-x-1">
                                        <i class="fas fa-fist-raised fa-lg"></i>
                                        <span class="text-sm">Desafiar</span>
                                    </a>
                                <% } %>
                            </div>
    
                            <div class="mt-2">
                                <button onclick="toggleComentarios(<%= postagens[j].id_post %>)" class="bg-red-700 hover:bg-red-800 text-white font-bold py-1 px-2 rounded-full mb-2">
                                    Mostrar Comentários
                                </button>
    
                                <div id="comentarios-<%= postagens[j].id_post %>" class="hidden">
                                    <h3 class="text-lg font-bold mb-2">Respostas</h3>
                                    <% let count = 0; %>
                                    <% for (let x = 0; x < resposta.length; x++) { 
                                        const userResposta = usuarios.find(user => user.id === resposta[x].usuario_id);
                                        if (postagens[j].id_post == resposta[x].postagem_id) { %>
                                            <% if (count < 5) { %>
                                                <div class="bg-gray-700 p-2 rounded-lg mb-2 shadow-sm flex items-center">
                                                    <img class="w-8 h-8 rounded-full mr-2" src="/imagens/<%= userResposta.img %>" alt="User Avatar">
                                                    <div>
                                                        <p class="font-bold text-gray-300"><%= userResposta.nome %></p>
                                                        <p class="text-gray-200 text-sm"><%= resposta[x].conteudo %></p>
                                                    </div>
                                                </div>
                                                <% count++; %>
                                            <% } %>
                                        <% } %>
                                    <% } %>
    
                                    <% if (resposta.length > 5) { %>
                                        <button onclick="loadMore(<%= postagens[j].id_post %>)" class="bg-red-700 hover:bg-red-800 text-white font-bold py-1 px-2 rounded-full">
                                            Ver Mais
                                        </button>
                                    <% } %>
                                </div>
                            </div>
                        </div>
                    <% } %>
                <% } %>
            </div>
        </div>
    </div>
    
